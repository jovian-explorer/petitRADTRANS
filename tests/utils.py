"""
Utility functions for tests.
"""
import os
import numpy as np


def create_radtrans_spectrum_correlated_k_ref():
    from .test_radtrans import init_parameters, radtrans_init_correlated_k, petitRADTRANS, \
        main_radtrans_init_with_correlated_k

    atmosphere = main_radtrans_init_with_correlated_k()

    np.savetxt(
        os.path.join(os.path.dirname(__file__), 'data', 'radtrans_spectrum_correlated_k_ref.dat'),
        np.transpose(
            np.asarray([
                petitRADTRANS.nat_cst.c / atmosphere.freq / 1e-4,
                atmosphere.transm_rad / petitRADTRANS.nat_cst.r_jup_mean
            ])
        ),
        header=f'File generated by tests.utils.create_radtrans_spectrum_correlated_k_ref '
               f'with petitRADTRANS {petitRADTRANS.version.version}\n'
               f'wavelength transit_radius\n'
               f'um R_jup'
    )
